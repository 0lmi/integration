version: '2'
services:
    #
    # mender-deployments
    #
    mender-deployments:
        image: mendersoftware/deployments:latest
        ports:
            - "8080:8080"
        networks:
            - mender

    #
    # mender-etcd
    #
    mender-etcd:
        image: microbox/etcd:latest
        ports:
            - "4001:4001"
            - "7001:7001"
        volumes:
            - /var/etcd/:/data
        #override command since the image entrypoint requires
        #these two args
        command:
            - -data-dir=/data
            - -name=mender-etcd
        networks:
            mender:
                aliases:
                    - etcd

    #
    # mender-gui
    #
    mender-gui:
        image: mendersoftware/gui:latest
        ports:
            - "8081:80"
        networks:
            - mender

    #
    # mender-api-gateway (dummy impl.)
    #
    mender-api-gateway:
        extends:
            file: common.yml
            service: mender-base
        build:
            context: .
            dockerfile: api-gateway/Dockerfile
        networks:
            mender:
                aliases:
                    - gateway

    #
    # mender-device-auth (dummy impl.)
    #
    mender-device-auth:
        extends:
            file: common.yml
            service: mender-base
        build:
            context: .
            dockerfile: device-auth/Dockerfile
        networks:
            - mender

networks:
    mender:
